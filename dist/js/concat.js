requirejs.config({baseUrl:"./src/",paths:{hbs:".././bower_components/require-handlebars-plugin/hbs",jquery:".././bower_components/jquery/dist/jquery.min",moment:".././bower_components/momentjs/min/moment.min"}}),requirejs(["scripts/util/windowresize","scripts/imageviewer/imageviewer.controller"],function(t,e){new e($("#js-image-viewer"));t.init()}),define(["jquery","hbs","./imageviewer.model","hbs!templates/image-item"],function(t,e,i,n){function r(t){this.$container=t,this.$backBtn=this.$container.find("#js-image-viewer-btn"),this.$title=this.$container.find("#js-image-viewer-title"),this.model=new i,this.getData()}return r.prototype.addListeners=function(){this.$container.find(".js-author").on("click",this.filter.bind(this,"author")),this.$container.find(".js-tag").on("click",this.filter.bind(this,"tag")),this.$backBtn.on("click",this.renderItems.bind(this,this.data,"back")),t(document).on("scroll",this.lazyLoadImages.bind(this)),t(window).on("resizecomplete",function(){this.lazyLoadImages()}.bind(this))},r.prototype.filter=function(e,i){i.preventDefault();var n=t(i.currentTarget).attr("data-filter-item"),r=t(i.currentTarget).attr("data-author-name"),a=r?r:n,s=this.data.filter(function(t){return"author"===e?t.author_id===n:t.tags.indexOf(n)>-1});this.renderItems(s),this.updateUI(e,a)},r.prototype.getData=function(){this.model.get("edenspiekermann").done(function(t){this.sortItems(t.items)}.bind(this))},r.prototype.lazyLoadImages=function(e){var i=this.$container.find("img"),n=t(document).scrollTop()+t(window).height();t(i).each(function(e,i){if(t(i).offset().top<n+100){var r=t(i).attr("data-src");t(i).attr("src",r),t(i).parent().addClass("image-item__link--loaded")}})},r.prototype.renderItems=function(t,e){this.$container.find("#js-image-items-wrapper").html(n({data:t})),this.lazyLoadImages(),this.addListeners(),"back"===e&&(this.$backBtn.addClass("image-viewer__btn--hidden"),this.$title.html("&lsaquo;Insert witty title here&rsaquo;").removeClass("image-viewer__title--narrow"))},r.prototype.separateTags=function(t){for(var e=0;e<t.length;e++){var i=t[e].tags.split(" ");t[e].tags=i}this.data=t,this.renderItems(t)},r.prototype.sortItems=function(t){t.sort(function(t,e){return new Date(e.date_taken).getTime()-new Date(t.date_taken).getTime()}),this.separateTags(t)},r.prototype.updateUI=function(e,i){t("html,body").animate({scrollTop:0},"500"),this.$title.html("Filtered on "+e+": "+i).addClass("image-viewer__title--narrow"),this.$backBtn.removeClass("image-viewer__btn--hidden")},r}),define(["jquery"],function(t){function e(){}return e.prototype.get=function(e){return t.ajax({url:"https://api.flickr.com/services/feeds/photos_public.gne?tags="+e+"&tagmode=all&format=json&jsoncallback=?",dataType:"jsonp",jsonp:"callback",data:{format:"json"}})},e}),define(["jquery"],function(t){function e(){var e;t(window).on("resize",function(){clearTimeout(e),e=setTimeout(function(){t(window).trigger("resizecomplete")},250)})}return{init:e}}),define(["hbs/handlebars","moment"],function(t,e){function i(t){return e(t).format("D/MM/YYYY HH:mm")}return t.registerHelper("formatDate",i),i}),define(["hbs/handlebars"],function(t){function e(t){return t.split(/[()]/)[1]}return t.registerHelper("splitString",e),e});